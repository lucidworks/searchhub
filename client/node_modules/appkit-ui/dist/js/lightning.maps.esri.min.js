/*! appkit-ui 2018-06-22 */
!function(){"use strict";function a(a,b,c,d){return{restrict:"E",scope:{},transclude:!0,link:function(e,f,g){function h(f){a.require(["esri/InfoTemplate","esri/layers/FeatureLayer","esri/map","esri/renderers/HeatmapRenderer","esri/tasks/FeatureSet","esri/geometry/Point","esri/symbols/SimpleMarkerSymbol","esri/Color","esri/graphic","esri/SpatialReference","esri/graphicsUtils"],function(a,h,j,k,l,m,n,o,p,q,r){function s(){if(e.facet=e.response.facets[g.facetName],null!=e.facet){i?f.removeLayer(e.heatmapFeatureLayer):i=!0;var a,d,j,s=[],t=new l,u=new q(4326),v=(new n).setStyle(n.STYLE_SQUARE).setColor(new o([255,0,0,.5]));angular.forEach(e.facet.filters,function(b,e){var f=c("actualValue")(b.val),g=f.split(","),h=g[0].trim(),i=g[1].trim();h=parseFloat(h),i=parseFloat(i),a=new m(i,h,u),d={OBJECTID:e,weight:b.count,x:i,y:h},j=new p(a,v,d),s.push(j)}),t.features=s,t.geometryType="esriGeometryPoint";var w={objectIdField:"OBJECTID",layerDefinition:{geometryType:"esriGeometryPoint",fields:[{name:"OBJECTID",type:"esriFieldTypeOID"},{name:"weight",type:"esriFieldTypeDouble"},{name:"x",type:"esriFieldTypeDouble"},{name:"y",type:"esriFieldTypeDouble"}]},featureSet:t},x={mode:h.MODE_SNAPSHOT,outFields:["weight"]};e.heatmapFeatureLayer=new h(w,x);var y=new k({field:"weight"});e.heatmapFeatureLayer.setRenderer(y),f.addLayer(e.heatmapFeatureLayer),b(function(){var a=r.graphicsExtent(t.features);f.setExtent(a,!0)},0)}}e.esri={},e.response=d.getResponse(g.response),null!=e.response&&s(),e.$on(g.response+"_updated",function(a,b){e.response=b,s()})})}var i=!1;e.loaded=!1,e.map={},g.javascriptApiUrl=null==g.javascriptApiUrl?"//js.arcgis.com/3.15compact":g.javascriptApiUrl,g.basemap=null==g.basemap?"topo":g.basemap,a.bootstrap({url:g.javascriptApiUrl}).then(function(){e.loaded=!0,e.map.options={basemap:g.basemap,center:[-122.676207,45.523452],zoom:13,sliderStyle:"small"}},function(){e.loaded=!0,g.basemap=null==g.basemap?"topo":g.basemap,e.map.options={basemap:g.basemap,center:[-122.676207,45.523452],zoom:13,sliderStyle:"small"}}),e.onMapLoad=h},template:function(a,b){var c=Math.floor(1e3*Math.random()+1);b.height=null==b.height?"400px":b.height,b.width=null==b.width?"100%":b.width;var d="<style>.map"+c+"{height:"+b.height+"; width:"+b.width+';}</style><div class="map'+c+'" style="height:'+b.height+"; width:"+b.width+'; position:relative;"><esri-map id="esrimap"style="height: 100%; width: 100%;" map-options="map.options" ng-if="loaded" load="onMapLoad"></esri-map></div>';return d}}}angular.module("lightning").directive("esriHeatmap",a),a.$inject=["esriLoader","$timeout","$filter","ResponseService"]}(),function(){"use strict";function a(){var a={restrict:"E",template:function(a,b){var c="";return"true"==b.toggleLayers&&(c+='<style>#layerListPane{width:200px !important;}</style><div id="layerListPane" data-dojo-type="dijit/layout/ContentPane" data-dojo-props="region:\'right\'"  style="position: absolute;right: 0px;z-index: 100;"><div id="layerList"></div></div>'),c}};return a}angular.module("lightning").directive("esriWebmap",a)}();