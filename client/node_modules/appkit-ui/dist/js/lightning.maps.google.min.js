/*! appkit-ui 2018-06-22 */
!function(){"use strict";function a(a,b,c){return{restrict:"E",scope:{options:"=?"},transclude:!0,link:function(d,e,f){function g(){if(d.facet=d.response.facets[f.facetName],null!=d.facet)if(h){if(null!=d.heatLayer){var a=[],c=new google.maps.LatLngBounds;angular.forEach(d.facet.filters,function(d){var e=b("actualValue")(d.val),f=e.split(","),g=f[0].trim(),h=f[1].trim();g=parseFloat(g),h=parseFloat(h);var i=new google.maps.LatLng(g,h);c.extend(i);var j={};j.location=i,j.weight=d.count,a.push(j)}),d.heatLayer.setData(a),d.googleBounds=c;var e=d.googlemap.getGMap();google.maps.event.trigger(e,"resize"),e.fitBounds(d.googleBounds)}}else d.mapOptions={scrollwheel:f.scrollToZoom},null!=d.options&&angular.extend(d.mapOptions,d.options),d.googlemap={},d.map={center:{latitude:38.9,longitude:-77.016},zoom:13,showHeat:!0,heatLayerCallback:function(a){var c=[],e=new google.maps.LatLngBounds;angular.forEach(d.facet.filters,function(a){var d=b("actualValue")(a.val),f=d.split(",");if(!(f.length<2)){var g=f[0].trim(),h=f[1].trim();g=parseFloat(g),h=parseFloat(h);var i=new google.maps.LatLng(g,h);e.extend(i);var j={};j.location=i,j.weight=a.count,c.push(j)}}),a.setData(c),d.googleBounds=e;var f=d.googlemap.getGMap();google.maps.event.trigger(f,"resize"),f.fitBounds(d.googleBounds),h=!0,d.heatLayer=a}}}var h=!1;f.scrollToZoom="true"==f.scrollToZoom,a.then(function(){d.response=c.getResponse(f.response),null!=d.response&&g(),d.$on(f.response+"_updated",function(a,b){d.response=b,g()})})},template:function(a,b){var c=Math.floor(1e3*Math.random()+1);b.height=null==b.height?"400px":b.height,b.width=null==b.width?"100%":b.width;var d="<style>.map"+c+" .angular-google-map-container{height:"+b.height+"; width:"+b.width+';}</style><div class="map'+c+'" style="height:'+b.height+"; width:"+b.width+'; position:relative;" ng-if="response != null"><ui-gmap-google-map center="map.center" zoom="map.zoom" options="mapOptions" control="googlemap" ng-if="map != null"><ui-gmap-layer namespace="visualization" type="HeatmapLayer" show="map.showHeat" onCreated="map.heatLayerCallback"></ui-gmap-layer></ui-gmap-google-map></div>';return d}}}angular.module("lightning").directive("geoHeatmap",a),a.$inject=["uiGmapGoogleMapApi","$filter","ResponseService"]}();